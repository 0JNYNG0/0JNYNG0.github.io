---
title:  "[Unity 2D] 무한 맵 이동" 
excerpt: "[골드메탈] 뱀서라이크 강좌 노트"

categories:
  - Unitystudy
tags:
  - [Unity2D]

toc: true
toc_sticky: true
 
date: 2022-11-30
last_modified_at: 2022-12-06

---
```
하나씩 차근차근 개인적으로 공부한 것을 기록하는 블로그입니다.
참고하시고 잘못되거나 고쳐야 할 부분이 있다면 지적 부탁드립니다!
읽어주셔서 감사합니다🙂
```
***
🌟**유튜브 '골드메탈'님의 [유니티 뱀서라이크] 강좌를 보고 정리해놓은 글입니다.**🌟<br>
<a href="https://www.youtube.com/watch?v=SNjgew0VhHY" class="btn btn--warning">골드메탈님의 [뱀서라이크 강좌] 보러가기 🎮</a>
{: .notice--primary}

## 타일 그리기
본 강좌 Tiles 폴더의 에셋을 활용하고, 에셋이 약간 깨져있을 것이므로 타일은 다시 생성하는 과정을 거친다.<br>
- **Window > 2D > Tile Palette** 팔레트 창 열기<br>
![111](https://user-images.githubusercontent.com/67769404/204818446-e4070ff4-a33d-487e-a9aa-60d2620f7a32.png)<br><br>
- 기존의 RanTile 파일을 삭제해주고 새로운 랜덤 타일 에셋을 하나 만들어주도록 한다<br>
![111](https://user-images.githubusercontent.com/67769404/204819045-e8c44b7f-141a-4dcc-a1a3-dfe7f59f1498.png)<br><br>
- '+' 추가 버튼을 누르고 **2D > Tiles > Rule Tile**로 타일 에셋을 생성한다<br>
![111](https://user-images.githubusercontent.com/67769404/204819897-a5358f0d-ace0-4ef8-bc05-e4e0382d14dd.png)<br><br>

- ***Rule Tile*** : 인접한 타일에 따라 이미지가 정해지는 타일<br>
해당 강좌에서는 Output 설정을 Random으로 할 것이기 때문에 또다른 Rule Tile 기능은 사용하지 않는다
- 새로만든 Ran Tile 파일을 누르고 Inspector 우측 상단 좌물쇠 버튼을 눌러준 뒤 아래와 같이 설정해준다<br>(좌물쇠 버튼은 편집하기 쉽게 해당 Inspector 창을 고정시켜놓는 장치이다)<br>
![111](https://user-images.githubusercontent.com/67769404/204823040-0f7f7469-4cbe-4897-bcc0-0ec06f1bad2f.png)<br><br>
- Tile 0부터 Tile 5까지 개수를 달리하여 타일이 나타나는 빈도수 확률을 조절했다
<br>
- 좌물쇠 버튼을 해제해주고 Tile Palette 창 팔레트에 방금 설정해놓은 Ran Tile 타일 에셋을 Drag&Drop으로 덮어씌워준다.<br>
![111](https://user-images.githubusercontent.com/67769404/204824744-2f814227-bb25-4221-a06d-a3e0b2cce697.png)<br><br>

이제 직접 Scene창에 타일을 그려보자.<br>

- Hierarchy에 **2D Object > TileMap > Rectangular**로 새로운 타일맵을 추가해준다.<br>
![111](https://user-images.githubusercontent.com/67769404/204827753-920321d0-f7b6-48ef-b74b-129f9ae3107b.png)<br><br>
그럼 아래와 같이 Grid > Tilemap 계층 파일이 생긴다<br>
![1111](https://user-images.githubusercontent.com/67769404/204827775-aacafe39-09fe-4d44-84da-6d57358f2a6a.png)<br><br>

이제 직접 그려보자.<br>
- 이전에 열어둔 Tile Palette에서 Default Brush에서 Line Brush로 바꿔준다.<br>
![111](https://user-images.githubusercontent.com/67769404/205930145-872e7aec-0346-4261-ae7d-947f08f2fbf9.png)<br><br>

- 타일을 그리기 위해 Tile Palette에서 원하는 타일을 클릭한 후 상단 브러시 아이콘이 활성화 되었는지 확인해주자. 그리고 Scene에서 한 시작점을 클릭하고 마지막 지점을 클릭하면 직선형태로 타일이 그려지는 것을 확인할 수 있다.<br>
![111](https://user-images.githubusercontent.com/67769404/205931680-544cc016-0738-471f-83a6-4451ef9786c0.png)<br><br>
- 위와 같은 방법으로 아래처럼 20 x 20 타일 테두리를 그려주자.<br>
![111](https://user-images.githubusercontent.com/67769404/205933479-354872ca-ac89-4767-b49d-f6961fce7847.png)<br><br>

- 이제 남은 빈 칸들을 모두 채워주기 위해 페인트 도구를 사용할 것이다. 이는 Default Brush를 선택한 뒤 페인트 아이콘을 클릭해 채우고자하는 빈 칸을 클릭하면 된다.<br>
![111](https://user-images.githubusercontent.com/67769404/205934470-3c0f3e9f-751e-48a8-8c25-b9c474bbd05e.png)<br><br>

- Ran Tile이라고 만든 Rule Tile 파일의 Inspector창에 Noise라는 설정 수치 값을 변경시키면 타일들의 랜덤한 모양을 조절할 수 있다.<br>
![111](https://user-images.githubusercontent.com/67769404/205935668-622f920b-e3d2-4c90-8f5b-b3734487ab84.png)<br><br>

## 재배치 이벤트 준비
플레이어가 맵 끝으로 이동을 할 때, 플레이어와 멀어지는 반대쪽 부분의 타일을 이동하고 있는 앞 부분에 재배치를 함으로써 무한 맵을 구현하는 것이 해당 강의의 목표이다.

- 앞서 만든 Tilemap의 Inspector 컴포넌트로 Tilemap Collider 2D 컴포넌트를 추가한다.<br>
![111](https://user-images.githubusercontent.com/67769404/205938077-e97d0c6a-deee-4105-898f-db4256c68eba.png)<br><br>

Scene 창의 타일들을 보면 연두색으로 각 타일 하나씩 그리드 형태로 경계선들이 생긴 것을 볼 수 있다.<br>
- 그리고 이 타일마다 나눠진 형태를 하나로 합쳐주기 위해 Composite Collider 2D 컴포넌트 또한 추가해주자.(추가하면 Rigidbody 2D 컴포넌트도 꼭 필요하기 때문에 자동으로 추가된다.)
- Tilemap Collider 2D 컴포넌트에서 Used By Composite 속성을 체크해주자. 이는 앞서 추가한 Composite Collider 2D 컴포넌트에 모든 것을 위임하겠다는 뜻이다.
- 체크했다면 기존의 타일맵 Is Trigger 속성이 사라진 것을 알 수 있고, 고로 타일맵과 플레이어가 충돌하면 안되기 때문에 Composite Collider 2D 컴포넌트에서 Is Trigger에 체크를 해주자.<br>
![111](https://user-images.githubusercontent.com/67769404/205940117-91d2ea88-64f7-4cf2-9844-b51ba0d9a94d.png)<br><br>

- Tilemap의 Rigidbody 2D 컴포넌트의 Body Type 속성을 고정적인 값인 Kinematic이나 Static으로 설정해준다.<br>
![111](https://user-images.githubusercontent.com/67769404/205942192-e28da90c-1513-43f3-a4a7-e0bc2b05deaf.png)<br><br>

- 태그도 새롭게 Ground와 Area를 추가해주고 Tilemap의 태그는 Ground로 설정해주자.<br>
![1111](https://user-images.githubusercontent.com/67769404/205942202-bad1374a-b1ca-4dee-9e53-6227cc088d03.png)<br><br>
![11111](https://user-images.githubusercontent.com/67769404/205942209-de9baaaf-35bc-49e7-82d4-9a59b1efa337.png)<br><br>
![111111](https://user-images.githubusercontent.com/67769404/205942217-7570a3de-7bc1-4547-bb33-1f04317c7a8d.png)<br><br>

- 플레이어의 이동 공간을 파악을 해야 하는데 플레이어의 컴포넌트가 점점 복잡해지므로 플레이어 오브젝트에 Area라는 자식 오브젝트를 따로 만들어주자.
- 그리고 Box Collider 2D 컴포넌트를 추가해주고 Size 속성을 타일맵 20x20에 맞게 X:20, Y:20으로 설정해주고(그럼 이전에 그린 타일과 범위가 동일하게 설정된다), 플레이어와의 충돌이 일어나면 안되기 때문에 Is Trigger 또한 체크해준다.
- 새로 만든 Area 태그도 지정해준다.
![111](https://user-images.githubusercontent.com/67769404/205944500-8cebb536-14a0-453a-8d70-98d7b8be3c4c.png)